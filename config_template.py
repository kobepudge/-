"""
==============================================================================
策略参数配置模板
==============================================================================

本文件提供了所有可配置参数的说明和建议值。
您可以根据实际情况调整这些参数，然后替换 gkoudai_au_strategy.py 中的对应部分。

使用方法：
1. 复制下方的参数配置
2. 根据您的需求修改
3. 替换主策略文件中的配置部分
4. 重新部署到高宽代平台

==============================================================================
"""

# ==============================================================================
# 基础配置
# ==============================================================================

# ============== 交易品种配置 ==============
SYMBOL = "au2512.SHFE"  # 交易品种

# 其他可选品种：
# "IF2503.CFFEX"  # 沪深300股指期货
# "IC2503.CFFEX"  # 中证500股指期货
# "IH2503.CFFEX"  # 上证50股指期货
# "ag2512.SHFE"   # 白银期货
# "cu2503.SHFE"   # 铜期货

TRADE_VOLUME = 1  # 每次交易手数

# 建议：
# - 初期测试：1 手
# - 小资金：1-2 手
# - 中等资金：3-5 手
# - 大资金：根据资金量动态计算


# ==============================================================================
# AI 决策配置
# ==============================================================================

# ============== DeepSeek API 配置 ==============
DEEPSEEK_API_KEY = "sk-c7c94df2cbbb423698cb895f25534501"
DEEPSEEK_API_URL = "https://api.deepseek.com/v1/chat/completions"
DEEPSEEK_MODEL = "deepseek-chat"

# 其他可用模型（需要对应的 API Key）：
# "deepseek-coder"  # 代码优化版本（非交易用途）
# "deepseek-reasoner"  # 推理增强版本（可尝试）

# ============== AI 调用频率 ==============
AI_DECISION_INTERVAL = 180  # AI 决策间隔（秒）

# 调整建议：
# - 高频交易：120 秒（2分钟） - 成本高，决策频繁
# - 标准配置：180 秒（3分钟） - 推荐，平衡性价比
# - 低频交易：300 秒（5分钟） - 成本低，可能错过机会
# - 极低频：600 秒（10分钟） - 适合趋势跟踪

# 说明：
# - 间隔越短，API 调用越频繁，成本越高
# - 间隔越长，可能错过短期机会
# - 黄金期货波动适中，建议 3-5 分钟

AI_REQUEST_TIMEOUT = 10  # API 请求超时（秒）

# 调整建议：
# - 网络稳定：5-10 秒
# - 网络不稳定：15-20 秒
# - 说明：超时会跳过本次决策，保持上次状态


# ==============================================================================
# Tick 执行配置
# ==============================================================================

# ============== Tick 数据缓存 ==============
TICK_BUFFER_SIZE = 100  # 缓存最近 N 个 tick

# 调整建议：
# - 小缓存：50-100 个 tick（~5-10秒数据）
# - 标准配置：100-200 个 tick（~10-20秒数据）
# - 大缓存：200-500 个 tick（~20-50秒数据）

# 说明：
# - 缓存越大，量能统计越平滑，但响应可能略慢
# - 黄金期货 tick 频率中等，100 个缓存足够

# ============== 量能判断 ==============
VOLUME_SURGE_THRESHOLD = 1.5  # 量能突增阈值（倍数）

# 调整建议：
# - 激进策略：1.3-1.5 倍（交易频繁，可能误判）
# - 标准配置：1.5-2.0 倍（推荐，平衡）
# - 保守策略：2.0-3.0 倍（交易少，质量高）

# 说明：
# - 阈值越低，触发越频繁，交易次数越多
# - 阈值越高，只在强量能突增时入场，胜率可能更高
# - 建议先从 1.5 开始，根据回测结果调整

VOLUME_CHECK_WINDOW = 20  # 量能统计窗口（最近 N 个 tick）

# 调整建议：
# - 短窗口：10-20 个 tick（对短期波动敏感）
# - 标准配置：20-30 个 tick（推荐）
# - 长窗口：30-50 个 tick（更平滑，但响应慢）

# 说明：
# - 窗口越小，对瞬时量能变化越敏感
# - 窗口越大，统计越稳定，但可能错过快速机会


# ==============================================================================
# 风控配置
# ==============================================================================

# ============== 止损止盈 ==============
STOP_LOSS_PCT = 0.005  # 止损 0.5%
TAKE_PROFIT_PCT = 0.01  # 止盈 1.0%

# 调整建议（根据品种波动特性）：

# 黄金期货（波动中等）：
# - 保守：止损 0.3%，止盈 0.6%（盈亏比 1:2）
# - 标准：止损 0.5%，止盈 1.0%（盈亏比 1:2）推荐
# - 激进：止损 0.8%，止盈 2.0%（盈亏比 1:2.5）

# 股指期货（波动大）：
# - 保守：止损 0.5%，止盈 1.0%
# - 标准：止损 1.0%，止盈 2.0%
# - 激进：止损 1.5%，止盈 3.0%

# 说明：
# - 盈亏比建议保持在 1:2 左右
# - 止损过小：容易被震出
# - 止损过大：单笔风险高
# - 止盈过小：盈利不足
# - 止盈过大：可能回吐利润

# ============== 置信度阈值 ==============
MIN_CONFIDENCE = 60  # AI 最低置信度阈值

# 调整建议：
# - 激进策略：50-60（交易频繁）
# - 标准配置：60-70（推荐）
# - 保守策略：70-80（交易少，质量高）

# 说明：
# - 阈值越高，只在 AI 高度确信时才交易
# - 阈值越低，交易机会更多，但可能准确性下降

# ============== 交易频率限制 ==============
MAX_TRADES_PER_DAY = 20  # 每日最大交易次数

# 调整建议：
# - 低频策略：5-10 次
# - 标准配置：10-20 次（推荐）
# - 高频策略：20-50 次

# 说明：
# - 限制交易次数可防止过度交易
# - 过多交易会增加手续费成本
# - 如果频繁触及上限，考虑提高量能阈值或置信度

# ============== 强制平仓时间 ==============
FORCE_CLOSE_TIME = "14:55:00"  # 强制平仓时间

# 调整建议：
# - 黄金期货：14:55:00（白盘收盘 15:00）
# - 股指期货：14:55:00（收盘 15:00）
# - 夜盘品种：根据夜盘结束时间调整

# 说明：
# - 日内交易策略必须设置强制平仓
# - 建议在收盘前 5 分钟平仓，避免流动性风险
# - 如果有夜盘，可以设置 23:25:00 等


# ==============================================================================
# 调试配置
# ==============================================================================

ENABLE_DEBUG_LOG = True  # 是否启用详细日志

# 调整建议：
# - 开发测试期：True（查看详细运行情况）
# - 稳定运行期：False（减少日志输出）

# 说明：
# - 启用详细日志会输出每个 tick 的量能判断
# - 如果策略稳定，可以关闭以减少日志量


# ==============================================================================
# 预设配置方案
# ==============================================================================

# ============== 方案 1：保守稳健型 ==============
# 适用场景：初期测试、小资金、风险厌恶
CONSERVATIVE_CONFIG = {
    'AI_DECISION_INTERVAL': 300,         # 5 分钟决策
    'VOLUME_SURGE_THRESHOLD': 2.0,       # 2 倍量能
    'STOP_LOSS_PCT': 0.003,              # 止损 0.3%
    'TAKE_PROFIT_PCT': 0.006,            # 止盈 0.6%
    'MIN_CONFIDENCE': 75,                # 置信度 75%
    'MAX_TRADES_PER_DAY': 10,            # 每日最多 10 次
}

# ============== 方案 2：标准平衡型 ==============
# 适用场景：正常运营、中等资金、平衡风险收益
STANDARD_CONFIG = {
    'AI_DECISION_INTERVAL': 180,         # 3 分钟决策
    'VOLUME_SURGE_THRESHOLD': 1.5,       # 1.5 倍量能
    'STOP_LOSS_PCT': 0.005,              # 止损 0.5%
    'TAKE_PROFIT_PCT': 0.01,             # 止盈 1%
    'MIN_CONFIDENCE': 60,                # 置信度 60%
    'MAX_TRADES_PER_DAY': 20,            # 每日最多 20 次
}

# ============== 方案 3：激进高频型 ==============
# 适用场景：追求高频、大资金、风险承受能力强
AGGRESSIVE_CONFIG = {
    'AI_DECISION_INTERVAL': 120,         # 2 分钟决策
    'VOLUME_SURGE_THRESHOLD': 1.3,       # 1.3 倍量能
    'STOP_LOSS_PCT': 0.008,              # 止损 0.8%
    'TAKE_PROFIT_PCT': 0.016,            # 止盈 1.6%
    'MIN_CONFIDENCE': 50,                # 置信度 50%
    'MAX_TRADES_PER_DAY': 30,            # 每日最多 30 次
}


# ==============================================================================
# 成本估算工具
# ==============================================================================

def estimate_daily_cost(decision_interval, trades_per_day):
    """
    估算每日成本

    参数:
        decision_interval: AI 决策间隔（秒）
        trades_per_day: 每日交易次数
    """
    # AI API 成本
    trading_hours = 4  # 黄金白盘 4 小时
    api_calls_per_day = (trading_hours * 3600) / decision_interval
    api_cost_per_call = 0.00034  # 元
    daily_api_cost = api_calls_per_day * api_cost_per_call

    # 交易手续费（黄金期货示例）
    commission_per_trade = 10  # 元/手（单边）
    daily_commission = trades_per_day * commission_per_trade * 2  # 双边

    # 总成本
    total_daily_cost = daily_api_cost + daily_commission

    print(f"=== 每日成本估算 ===")
    print(f"AI API 成本: {daily_api_cost:.2f} 元")
    print(f"交易手续费: {daily_commission:.2f} 元")
    print(f"每日总成本: {total_daily_cost:.2f} 元")
    print(f"每月总成本: {total_daily_cost * 20:.2f} 元 (按20个交易日)")

    return total_daily_cost


# 使用示例
if __name__ == "__main__":
    print("方案 1：保守稳健型")
    estimate_daily_cost(300, 10)
    print()

    print("方案 2：标准平衡型")
    estimate_daily_cost(180, 20)
    print()

    print("方案 3：激进高频型")
    estimate_daily_cost(120, 30)


# ==============================================================================
# 参数调优建议
# ==============================================================================

"""
根据回测结果调优参数的建议流程：

1. 观察回测报告：
   - 总收益率：是否满意？
   - 最大回撤：是否可接受？
   - 胜率：是否 >50%？
   - 交易次数：是否合理？

2. 如果收益率低：
   → 降低 MIN_CONFIDENCE（增加交易机会）
   → 降低 VOLUME_SURGE_THRESHOLD（更容易触发）
   → 调整 TAKE_PROFIT_PCT（持有更久）

3. 如果回撤过大：
   → 提高 MIN_CONFIDENCE（只交易高质量信号）
   → 缩小 STOP_LOSS_PCT（更严格止损）
   → 提高 VOLUME_SURGE_THRESHOLD（减少交易）

4. 如果胜率低：
   → 提高 MIN_CONFIDENCE（提高决策质量）
   → 提高 VOLUME_SURGE_THRESHOLD（只在强信号时入场）
   → 优化 Prompt（改进 AI 决策逻辑）

5. 如果交易次数过多：
   → 提高 VOLUME_SURGE_THRESHOLD
   → 提高 MIN_CONFIDENCE
   → 增加 AI_DECISION_INTERVAL

6. 如果交易次数过少：
   → 降低 VOLUME_SURGE_THRESHOLD
   → 降低 MIN_CONFIDENCE
   → 减少 AI_DECISION_INTERVAL

7. 如果频繁止损：
   → 检查入场时机（是否量能判断过于激进）
   → 适当放宽 STOP_LOSS_PCT
   → 提高 VOLUME_SURGE_THRESHOLD（更严格的入场条件）

8. 如果止盈不足：
   → 调整 TAKE_PROFIT_PCT
   → 考虑引入移动止盈
   → 优化 Prompt，让 AI 判断更长期的趋势
"""


# ==============================================================================
# 不同品种的推荐配置
# ==============================================================================

# ============== 黄金期货 (au) ==============
AU_CONFIG = {
    'SYMBOL': 'au2512.SHFE',
    'AI_DECISION_INTERVAL': 180,
    'VOLUME_SURGE_THRESHOLD': 1.5,
    'STOP_LOSS_PCT': 0.005,
    'TAKE_PROFIT_PCT': 0.01,
    'MIN_CONFIDENCE': 60,
    'MAX_TRADES_PER_DAY': 20,
    'FORCE_CLOSE_TIME': '14:55:00',
}

# ============== 沪深300股指 (IF) ==============
IF_CONFIG = {
    'SYMBOL': 'IF2503.CFFEX',
    'AI_DECISION_INTERVAL': 120,          # 股指波动快，2分钟
    'VOLUME_SURGE_THRESHOLD': 1.8,        # 股指量能波动大
    'STOP_LOSS_PCT': 0.008,               # 止损 0.8%
    'TAKE_PROFIT_PCT': 0.015,             # 止盈 1.5%
    'MIN_CONFIDENCE': 65,
    'MAX_TRADES_PER_DAY': 25,
    'FORCE_CLOSE_TIME': '14:55:00',
}

# ============== 白银期货 (ag) ==============
AG_CONFIG = {
    'SYMBOL': 'ag2512.SHFE',
    'AI_DECISION_INTERVAL': 180,
    'VOLUME_SURGE_THRESHOLD': 1.5,
    'STOP_LOSS_PCT': 0.006,               # 白银波动稍大
    'TAKE_PROFIT_PCT': 0.012,
    'MIN_CONFIDENCE': 60,
    'MAX_TRADES_PER_DAY': 20,
    'FORCE_CLOSE_TIME': '14:55:00',
}


# ==============================================================================
# 使用说明
# ==============================================================================

"""
如何应用这些配置到主策略文件：

方法 1：直接替换（推荐）
1. 从上方复制您想要的配置参数
2. 打开 gkoudai_au_strategy.py
3. 找到文件开头的配置部分
4. 替换对应的参数值
5. 保存并重新部署

方法 2：使用预设方案
1. 选择一个预设方案（保守/标准/激进）
2. 复制该方案的所有参数
3. 替换主文件中的对应参数
4. 保存并重新部署

方法 3：自定义配置
1. 先使用标准配置运行回测
2. 观察回测报告的问题
3. 根据上方的"参数调优建议"调整参数
4. 重新回测验证
5. 反复迭代直到满意

注意事项：
- 每次修改参数后都要重新回测验证
- 不要一次修改太多参数，单变量测试更容易定位问题
- 记录每次参数调整和结果，方便对比
- 模拟盘验证至少 1-2 周后再考虑实盘
"""
