# 快速参考卡 - AI自主交易策略

## 📌 当前版本

**版本**: v3.0 (5分钟趋势分析版)
**文件**: `gkoudai_au_strategy_autonomous.py` (1007行)
**更新日期**: 2025-11-03

---

## ⚡ 核心配置 (一目了然)

```python
# 交易标的
SYMBOL = "au2512.SHFE"              # 黄金2025年12月合约

# AI配置
DEEPSEEK_API_KEY = "sk-c7c94df2cbbb423698cb895f25534501"
AI_DECISION_INTERVAL = 60           # 1分钟决策一次
API_TIMEOUT = 30                    # 30秒超时
MIN_AI_CONFIDENCE = 0.6             # 最低信心度阈值

# 风控参数
MAX_SINGLE_TRADE_LOSS_PCT = 0.02   # 单笔最大亏损2%
MAX_DAILY_LOSS_PCT = 0.05           # 单日最大亏损5%
FORCE_CLOSE_TIME = "14:55:00"       # 强制平仓时间

# 数据配置
K线周期: 1分钟数据收集, 5分钟趋势分析
数据窗口: 1分钟200根, 聚合为5分钟40根
指标计算: 基于5分钟K线
```

---

## 🔥 3个最重要的变化 (v3.0)

### 1. AI决策频率: 2分钟 → 1分钟 ⚡

**更快响应市场变化**

### 2. 趋势分析周期: 1分钟 → 5分钟 📊

**过滤噪音, 提高信号质量**

### 3. 技术指标观察窗口延长5倍 🔭

- EMA20: 20分钟 → 100分钟
- EMA60: 60分钟 → 300分钟

---

## 🚀 部署三步走

### Step 1: 上传代码 (1分钟)

```
1. 打开 gkoudai_au_strategy_autonomous.py
2. Ctrl+A 全选, Ctrl+C 复制
3. 登录Gkoudai平台 → 新建策略
4. 粘贴代码 → 保存
```

### Step 2: 配置参数 (30秒)

```
品种: au2512.SHFE
初始资金: 100000 (10万)
模式: 模拟盘 (建议先测试)
```

### Step 3: 启动并观察 (5-10分钟)

```
✅ 看到日志: "策略启动完成,开始获取历史数据..."
⏳ 等待5分钟: "K线数据不足: XXX/300, 等待更多数据..."
✅ 数据就绪: "5分钟K线数据加载成功: 60根"
✅ AI开始工作: "正在调用AI进行决策..."
```

---

## 📊 预期性能 (供参考)

| 指标 | 预期值 | 说明 |
|------|--------|------|
| **AI调用频率** | 每分钟1次 | 60次/小时 |
| **日均交易次数** | 5-8次 | AI只在高信心度(>0.6)时入场 |
| **目标胜率** | 55-65% | 依赖AI决策质量 |
| **目标盈亏比** | 2:1 - 3:1 | AI动态计算止损止盈 |
| **单日成本** | ~¥0.02 | DeepSeek API费用 |

---

## ⚠️ 3个常见问题

### Q1: 启动后一直显示"K线数据不足"?

**答**: 正常! 需要等待5分钟累积300根1分钟数据。

**预期日志**:
```
[调试] K线数据不足: 150/300, 等待更多数据...
[调试] K线数据不足: 200/300, 等待更多数据...
[调试] K线数据不足: 250/300, 等待更多数据...
✅ [调试] 5分钟K线数据加载成功: 60根
```

### Q2: AI调用失败 "Read timed out"?

**答**: 网络波动导致超时,已将超时时间从10秒增加到30秒。

**解决**: 重新上传最新代码 (API_TIMEOUT = 30)

### Q3: 回测无法启动或数据不足?

**答**: 回测时间段太短,建议至少3天以上。

**原因**: 需要300根1分钟K线,短时间段可能没有足够数据。

---

## 📈 日志关键词速查

| 日志 | 含义 | 状态 |
|------|------|------|
| `策略启动完成` | 初始化成功 | ✅ 正常 |
| `K线数据不足: XXX/300` | 等待数据累积 | ⏳ 等待 |
| `5分钟K线数据加载成功` | 数据就绪 | ✅ 正常 |
| `正在调用AI进行决策` | AI工作中 | ✅ 正常 |
| `AI决策: buy` | 开多仓 | 📊 交易 |
| `AI决策: sell` | 开空仓 | 📊 交易 |
| `AI决策: hold` | 观望 | 💤 等待 |
| `AI决策: close` | 平仓 | 💰 退出 |
| `订单成交: 多 开 1手` | 开多仓成交 | ✅ 成功 |
| `[错误] AI调用失败` | API异常 | ❌ 问题 |
| `行情接口未连接` | 数据源问题 | ❌ 问题 |

---

## 🛠️ 快速故障排查

### 症状: "行情接口未连接"

```bash
✅ 检查: 合约代码是 au2512.SHFE (不是 au6666)
✅ 检查: 是否在交易时间内
   - 夜盘: 21:00 - 02:30
   - 日盘: 09:00 - 15:00
✅ 检查: 代码是否最新版本 (1007行)
```

### 症状: AI一直不调用

```bash
✅ 检查: API Key是否正确
✅ 检查: 网络连接是否正常
✅ 检查: 是否有 "K线数据不足" 日志 (等待数据)
```

### 症状: 订单提交失败

```bash
✅ 检查: 是否使用最新代码 (使用 buy/short 而非 order_volume)
✅ 检查: 资金是否充足
✅ 检查: 是否在交易时间内
```

---

## 📁 文档导航

| 文档 | 用途 | 详细程度 |
|------|------|----------|
| **LATEST_UPDATE_SUMMARY.md** | 最新更新说明 | ⭐⭐⭐ 详细 |
| **5MIN_AGGREGATION_SUMMARY.md** | 5分钟聚合实现 | ⭐⭐⭐ 详细 |
| **QUICK_REFERENCE.md** | 本文档 - 快速参考 | ⭐ 简明 |
| **DEPLOYMENT_GUIDE.md** | 部署指南 | ⭐⭐ 中等 |
| **API_FIX_SUMMARY.md** | API修复总结 | ⭐⭐ 中等 |
| **PRE_DEPLOYMENT_CHECKLIST.md** | 部署前检查清单 | ⭐ 简明 |

---

## 🎯 验收标准 (部署后1-3天)

### 阶段1: 启动验收 (前10分钟)

- [ ] 策略启动无报错
- [ ] 5分钟后数据加载成功
- [ ] AI开始每分钟决策

### 阶段2: 运行验收 (第1天)

- [ ] AI决策间隔稳定为1分钟
- [ ] 技术指标数值合理
- [ ] 有交易信号时订单能提交
- [ ] 止损止盈能正常触发

### 阶段3: 性能验收 (1-3天)

- [ ] 日均交易次数: 5-8次 (合理范围)
- [ ] 胜率: 50%+ (目标55-65%)
- [ ] 盈亏比: 1.5:1+ (目标2:1以上)
- [ ] 无频繁报错或异常

---

## 💡 优化建议 (运行稳定后)

### 如果交易太频繁 (>10次/天)

```python
# 提高信心度阈值
MIN_AI_CONFIDENCE = 0.65  # 原0.6
```

### 如果交易太少 (<3次/天)

```python
# 降低信心度阈值
MIN_AI_CONFIDENCE = 0.55  # 原0.6
```

### 如果胜率仍低 (<50%)

```python
# 考虑延长周期到10分钟
# 修改 _aggregate_to_5min() → _aggregate_to_10min()
# 每10根1分钟 → 1根10分钟
```

### 如果效果理想 (胜率>60%, 盈亏比>2:1)

```python
# 可以考虑增加仓位或杠杆
# (谨慎操作, 风控第一)
```

---

## 🔗 支持资源

**Gkoudai官方文档**:
https://quant.gkoudai.com/#/docs/index?url=/api_docs/py_portfolio/quick_start.html

**DeepSeek API文档**:
https://api.deepseek.com/

---

## ✅ 当前状态

```
代码状态: ✅ 完成, 语法检查通过
API兼容: ✅ 所有已知问题已修复
配置状态: ✅ 参数已优化
文档状态: ✅ 完整
部署准备: ✅ 可以立即上传测试
```

---

**准备好了! 现在就可以部署到Gkoudai平台进行测试。**

**记住**: 先模拟盘测试1-3天, 确认稳定后再考虑实盘!

---

**文档版本**: v1.0
**创建日期**: 2025-11-03
**对应策略版本**: v3.0 (gkoudai_au_strategy_autonomous.py, 1007行)
